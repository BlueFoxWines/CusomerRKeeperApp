{"version":3,"sources":["webpack:///./src/views/Auth/Login.vue","webpack:///./src/mixins/Timer.js","webpack:///./src/views/Auth/Login.vue?ab2b"],"names":["class","src","type","fullscreen","name","mode","CodeSent","Form","Code","rules","validateCode","validate-on-input","ValidationCodeIsEager","as","field","errors","errorMessage","Object","keys","length","$t","style","placeholder","autofocus","inputCode","disabled","Timeover","resend","TimeoutBeauty","sendcode","Phone","validatePhone","ValidationPhoneIsEager","setPhoneValue","active","IsLoading","is-full-page","data","Timeout","Timer","computed","SecondsNumber","parseInt","this","Hours","Math","floor","Minutes","Seconds","methods","decrementTimer","clearInterval","setTimer","setInterval","setTimerAgain","seconds","beforeUnmount","components","IonContent","IonPage","Field","Loading","directives","maska","mixins","LoadingState","mounted","login","value","result","Validation","eager","switchLoading","replace","$store","dispatch","then","finally","$router","$route","query","redirect","render"],"mappings":"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","file":"js/chunk-2d21e6fb.35edb0a4.js","sourcesContent":["<template>\n    <ion-page>\n        <ion-content :fullscreen=\"true\">\n            <section class=\"hero is-fullheight\">\n                <div class=\"hero-body\">\n                    <div class=\"container\">\n                        <div class=\"columns is-flex is-centered\">\n                            <figure class=\"logo image\">\n                                <img src=\"assets/logo/logo_full_bright.svg\">\n                            </figure>\n                        </div>\n                        <transition name=\"fade\" mode=\"out-in\">\n                            <template v-if=\"!CodeSent\">\n                                <Form class=\"form mt-5\" @submit=\"sendcode\">\n                                    <Field\n                                        v-slot=\"{ field, errors, errorMessage }\"\n                                        v-model=\"Form.Phone\"\n                                        name=\"Phone\"\n                                        :rules=\"validatePhone\"\n                                        :validate-on-input=\"ValidationPhoneIsEager\"\n                                        as=\"div\"\n                                        class=\"field\"\n                                        type=\"tel\"\n                                    >\n                                        <label class=\"label\" :class=\"{ 'has-text-danger': Object.keys(errors).length }\">\n                                            <template v-if=\"Object.keys(errors).length\">\n                                                {{ errorMessage }}\n                                            </template>\n                                            <template v-else>\n                                                {{ $t(\"Interface.Auth.Login.Phone.Label\") }}\n                                            </template>\n                                        </label>\n                                        <div class=\"control\">\n                                            <input\n                                                v-maska=\"'+7 (###) ###-##-##'\"\n                                                v-bind=\"field\"\n                                                class=\"input\"\n                                                type=\"tel\"\n                                                :class=\"{ 'is-danger': Object.keys(errors).length }\"\n                                                :placeholder=\"$t('Interface.Auth.Login.Phone.Placeholder')\"\n                                                @click=\"setPhoneValue()\"\n                                            >\n                                        </div>\n                                    </Field>\n\n                                    <div class=\"control\">\n                                        <button type=\"submit\" class=\"button is-theme is-fullwidth\">\n                                            {{ $t(\"Interface.Auth.Login.Button.Login\") }}\n                                        </button>\n                                    </div>\n                                </Form>\n                            </template>\n                            <template v-else>\n                                <Form class=\"form mt-5\">\n                                    <Field\n                                        v-slot=\"{ field, errors, errorMessage }\"\n                                        v-model=\"Form.Code\"\n                                        name=\"Code\"\n                                        :rules=\"validateCode\"\n                                        :validate-on-input=\"ValidationCodeIsEager\"\n                                        as=\"div\"\n                                        class=\"field\"\n                                        type=\"tel\"\n                                    >\n                                        <label class=\"label\" :class=\"{ 'has-text-danger': Object.keys(errors).length }\">\n                                            <template v-if=\"Object.keys(errors).length\">\n                                                {{ errorMessage }}\n                                            </template>\n                                            <template v-else>\n                                                {{ $t(\"Interface.Auth.Login.Code.Label\") }}\n                                            </template>\n                                        </label>\n                                        <div class=\"control\">\n                                            <input\n                                                v-maska=\"'# # # # # #'\"\n                                                v-bind=\"field\"\n                                                class=\"input\"\n                                                type=\"tel\"\n                                                :class=\"{ 'is-danger': Object.keys(errors).length }\"\n                                                style=\"text-align: center;\"\n                                                placeholder=\"• • • • • •\"\n                                                autofocus\n                                                @input=\"inputCode()\"\n                                            >\n                                        </div>\n                                    </Field>\n                                    <div class=\"control\">\n                                        <button type=\"submit\" class=\"button is-theme is-outlined is-fullwidth\" :disabled=\"!Timeover\" @click=\"resend\">\n                                            <template v-if=\"Timeover\">\n                                                {{ $t(\"Interface.Auth.Login.Button.ResendCode\") }}\n                                            </template>\n                                            <template v-else>\n                                                {{ $t(\"Interface.Auth.Login.Button.ResendTimer\") }} {{ TimeoutBeauty }}\n                                            </template>\n                                        </button>\n                                    </div>\n                                </Form>\n                            </template>\n                        </transition>\n                    </div>\n                </div>\n            </section>\n        </ion-content>\n        <loading :active=\"IsLoading\" :is-full-page=\"true\" />\n    </ion-page>\n</template>\n\n<script>\nimport { IonPage, IonContent } from \"@ionic/vue\"\nimport { Field, Form } from \"vee-validate\"\nimport { maska } from \"maska\"\nimport LoadingState from \"@/mixins/LoadingState\"\nimport Timer from \"@/mixins/Timer\"\nimport Validation from \"@/utils/Validation\"\nimport Loading from \"@/components/Loading.vue\"\nimport {\n    LOGIN_REQUEST_SENDCODE,\n    LOGIN_REQUEST_TOKEN\n} from \"@/store/actions/auth\"\n\nexport default {\n    name: \"Login\",\n    components: {\n        IonContent,\n        IonPage,\n        Field,\n        Form,\n        Loading\n    },\n    directives: { maska },\n    mixins: [LoadingState, Timer],\n    data() {\n        return {\n            Form: {\n                Phone: null,\n                Code: null\n            },\n            ValidationPhoneIsEager: false,\n            ValidationCodeIsEager: false,\n            CodeSent: false\n        }\n    },\n    mounted() {\n        this.Timeout = 180\n    },\n    methods: {\n        setPhoneValue() {\n            if (!this.Form.Phone) {\n                this.Form.Phone = \"+7\"\n            }\n        },\n        inputCode() {\n            if (this.Form.Code && this.Form.Code.length === 11) {\n                this.login()\n            }\n        },\n        validatePhone(value) {\n            const result = Validation.validatePhone(value)\n            this.ValidationPhoneIsEager = result.eager\n            return result.value\n        },\n        validateCode(value) {\n            const result = Validation.validateCode(value)\n            this.ValidationCodeIsEager = result.eager\n            return result.value\n        },\n        sendcode() {\n            if (this.Form.Phone && this.Form.Phone !== \"+7\") {\n                this.switchLoading()\n                // Phone normalization\n                const Phone = this.Form.Phone.replace(/[^a-zA-Z0-9 ]|\\s+/g, \"\")\n                this.$store.dispatch(LOGIN_REQUEST_SENDCODE, Phone)\n                    .then(() => {\n                        this.CodeSent = true\n                        this.setTimer()\n                    })\n                    .finally(() => this.switchLoading())\n            }\n        },\n        login() {\n            if (this.Form.Phone && this.Form.Code) {\n                this.switchLoading()\n                // Phone normalization\n                const Phone = this.Form.Phone.replace(/[^a-zA-Z0-9 ]|\\s+/g, \"\")\n                // Remove spaces and dash from Code\n                const Code = this.Form.Code.replace(/-|\\s+/g, \"\")\n                this.$store.dispatch(LOGIN_REQUEST_TOKEN, {\n                    \"Phone\": Phone,\n                    \"Code\": Code\n                })\n                    .then(() => {\n                        clearInterval(this.Timer)\n                        this.$router.replace(this.$route.query.redirect || \"/\")\n                    })\n                    .finally(() => this.switchLoading())\n            }\n        },\n        resend() {\n            this.setTimerAgain(180)\n            this.sendcode()\n        }\n    }\n}\n</script>\n","export default {\n    data: () => ({\n        Timeover: false,\n        Timeout: 360,\n        Timer: null\n    }),\n    computed: {\n        TimeoutBeauty() {\n            const SecondsNumber = parseInt(this.Timeout, 10)\n            const Hours = Math.floor(SecondsNumber / 3600)\n            let Minutes = Math.floor((SecondsNumber - (Hours * 3600)) / 60)\n            let Seconds = SecondsNumber - (Hours * 3600) - (Minutes * 60)\n\n            if (Minutes < 10) {\n                Minutes = `0${Minutes}`\n            }\n            if (Seconds < 10) {\n                Seconds = `0${Seconds}`\n            }\n\n            return `${Minutes}:${Seconds}`\n        }\n    },\n    methods: {\n        decrementTimer() {\n            this.Timeout -= 1\n            if (this.Timeout <= 0) {\n                this.Timeover = true\n                clearInterval(this.Timer)\n            }\n        },\n        setTimer() {\n            this.Timer = setInterval(this.decrementTimer, 1000)\n        },\n        setTimerAgain(seconds) {\n            this.Timeover = false\n            this.Timeout = seconds\n        }\n    },\n    beforeUnmount() {\n        clearInterval(this.Timer)\n    }\n}\n","import { render } from \"./Login.vue?vue&type=template&id=81403e1a\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}