{"version":3,"sources":["webpack:///./src/views/Auth/Login.vue","webpack:///./src/mixins/Timer.js","webpack:///./src/views/Auth/Login.vue?ebd8"],"names":["class","src","type","fullscreen","name","mode","CodeSent","Form","Code","rules","validateCode","validate-on-input","ValidationCodeIsEager","as","field","errors","errorMessage","Object","keys","length","$t","style","placeholder","autofocus","inputCode","disabled","Timeover","resend","TimeoutBeauty","sendcode","Phone","validatePhone","ValidationPhoneIsEager","setPhoneValue","active","IsLoading","is-full-page","data","Timeout","Timer","computed","SecondsNumber","parseInt","this","Hours","Math","floor","Minutes","Seconds","methods","decrementTimer","clearInterval","setTimer","setInterval","setTimerAgain","seconds","beforeUnmount","components","IonContent","IonPage","Field","Loading","directives","maska","mixins","LoadingState","mounted","login","value","result","Validation","eager","switchLoading","replace","$store","dispatch","then","finally","$router","$route","query","redirect","render"],"mappings":"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","file":"js/chunk-2d21e6fb.0bd223ad.js","sourcesContent":["<template>\r\n    <ion-page>\r\n        <ion-content :fullscreen=\"true\">\r\n            <section class=\"hero is-fullheight\">\r\n                <div class=\"hero-body\">\r\n                    <div class=\"container\">\r\n                        <div class=\"columns is-flex is-centered\">\r\n                            <figure class=\"logo image\">\r\n                                <img src=\"assets/logo/logo_full_bright.svg\">\r\n                            </figure>\r\n                        </div>\r\n                        <transition name=\"fade\" mode=\"out-in\">\r\n                            <template v-if=\"!CodeSent\">\r\n                                <Form class=\"form mt-5\" @submit=\"sendcode\">\r\n                                    <Field\r\n                                        v-slot=\"{ field, errors, errorMessage }\"\r\n                                        v-model=\"Form.Phone\"\r\n                                        name=\"Phone\"\r\n                                        :rules=\"validatePhone\"\r\n                                        :validate-on-input=\"ValidationPhoneIsEager\"\r\n                                        as=\"div\"\r\n                                        class=\"field\"\r\n                                        type=\"tel\"\r\n                                    >\r\n                                        <label class=\"label\" :class=\"{ 'has-text-danger': Object.keys(errors).length }\">\r\n                                            <template v-if=\"Object.keys(errors).length\">\r\n                                                {{ errorMessage }}\r\n                                            </template>\r\n                                            <template v-else>\r\n                                                {{ $t(\"Interface.Auth.Login.Phone.Label\") }}\r\n                                            </template>\r\n                                        </label>\r\n                                        <div class=\"control\">\r\n                                            <input\r\n                                                v-maska=\"'+7 (###) ###-##-##'\"\r\n                                                v-bind=\"field\"\r\n                                                class=\"input\"\r\n                                                type=\"tel\"\r\n                                                :class=\"{ 'is-danger': Object.keys(errors).length }\"\r\n                                                :placeholder=\"$t('Interface.Auth.Login.Phone.Placeholder')\"\r\n                                                @click=\"setPhoneValue()\"\r\n                                            >\r\n                                        </div>\r\n                                    </Field>\r\n\r\n                                    <div class=\"control\">\r\n                                        <button type=\"submit\" class=\"button is-theme is-fullwidth\">\r\n                                            {{ $t(\"Interface.Auth.Login.Button.Login\") }}\r\n                                        </button>\r\n                                    </div>\r\n                                </Form>\r\n                            </template>\r\n                            <template v-else>\r\n                                <Form class=\"form mt-5\">\r\n                                    <Field\r\n                                        v-slot=\"{ field, errors, errorMessage }\"\r\n                                        v-model=\"Form.Code\"\r\n                                        name=\"Code\"\r\n                                        :rules=\"validateCode\"\r\n                                        :validate-on-input=\"ValidationCodeIsEager\"\r\n                                        as=\"div\"\r\n                                        class=\"field\"\r\n                                        type=\"tel\"\r\n                                    >\r\n                                        <label class=\"label\" :class=\"{ 'has-text-danger': Object.keys(errors).length }\">\r\n                                            <template v-if=\"Object.keys(errors).length\">\r\n                                                {{ errorMessage }}\r\n                                            </template>\r\n                                            <template v-else>\r\n                                                {{ $t(\"Interface.Auth.Login.Code.Label\") }}\r\n                                            </template>\r\n                                        </label>\r\n                                        <div class=\"control\">\r\n                                            <input\r\n                                                v-maska=\"'# # # # # #'\"\r\n                                                v-bind=\"field\"\r\n                                                class=\"input\"\r\n                                                type=\"tel\"\r\n                                                :class=\"{ 'is-danger': Object.keys(errors).length }\"\r\n                                                style=\"text-align: center;\"\r\n                                                placeholder=\"• • • • • •\"\r\n                                                autofocus\r\n                                                @input=\"inputCode()\"\r\n                                            >\r\n                                        </div>\r\n                                    </Field>\r\n                                    <div class=\"control\">\r\n                                        <button type=\"submit\" class=\"button is-theme is-outlined is-fullwidth\" :disabled=\"!Timeover\" @click=\"resend\">\r\n                                            <template v-if=\"Timeover\">\r\n                                                {{ $t(\"Interface.Auth.Login.Button.ResendCode\") }}\r\n                                            </template>\r\n                                            <template v-else>\r\n                                                {{ $t(\"Interface.Auth.Login.Button.ResendTimer\") }} {{ TimeoutBeauty }}\r\n                                            </template>\r\n                                        </button>\r\n                                    </div>\r\n                                </Form>\r\n                            </template>\r\n                        </transition>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n        </ion-content>\r\n        <loading :active=\"IsLoading\" :is-full-page=\"true\" />\r\n    </ion-page>\r\n</template>\r\n\r\n<script>\r\nimport { IonPage, IonContent } from \"@ionic/vue\"\r\nimport { Field, Form } from \"vee-validate\"\r\nimport { maska } from \"maska\"\r\nimport LoadingState from \"@/mixins/LoadingState\"\r\nimport Timer from \"@/mixins/Timer\"\r\nimport Validation from \"@/utils/Validation\"\r\nimport Loading from \"@/components/Loading.vue\"\r\nimport {\r\n    LOGIN_REQUEST_SENDCODE,\r\n    LOGIN_REQUEST_TOKEN\r\n} from \"@/store/actions/auth\"\r\n\r\nexport default {\r\n    name: \"Login\",\r\n    components: {\r\n        IonContent,\r\n        IonPage,\r\n        Field,\r\n        Form,\r\n        Loading\r\n    },\r\n    directives: { maska },\r\n    mixins: [LoadingState, Timer],\r\n    data() {\r\n        return {\r\n            Form: {\r\n                Phone: null,\r\n                Code: null\r\n            },\r\n            ValidationPhoneIsEager: false,\r\n            ValidationCodeIsEager: false,\r\n            CodeSent: false\r\n        }\r\n    },\r\n    mounted() {\r\n        this.Timeout = 180\r\n    },\r\n    methods: {\r\n        setPhoneValue() {\r\n            if (!this.Form.Phone) {\r\n                this.Form.Phone = \"+7\"\r\n            }\r\n        },\r\n        inputCode() {\r\n            if (this.Form.Code && this.Form.Code.length === 11) {\r\n                this.login()\r\n            }\r\n        },\r\n        validatePhone(value) {\r\n            const result = Validation.validatePhone(value)\r\n            this.ValidationPhoneIsEager = result.eager\r\n            return result.value\r\n        },\r\n        validateCode(value) {\r\n            const result = Validation.validateCode(value)\r\n            this.ValidationCodeIsEager = result.eager\r\n            return result.value\r\n        },\r\n        sendcode() {\r\n            if (this.Form.Phone && this.Form.Phone !== \"+7\") {\r\n                this.switchLoading()\r\n                // Phone normalization\r\n                const Phone = this.Form.Phone.replace(/[^a-zA-Z0-9 ]|\\s+/g, \"\")\r\n                this.$store.dispatch(LOGIN_REQUEST_SENDCODE, Phone)\r\n                    .then(() => {\r\n                        this.CodeSent = true\r\n                        this.setTimer()\r\n                    })\r\n                    .finally(() => this.switchLoading())\r\n            }\r\n        },\r\n        login() {\r\n            if (this.Form.Phone && this.Form.Code) {\r\n                this.switchLoading()\r\n                // Phone normalization\r\n                const Phone = this.Form.Phone.replace(/[^a-zA-Z0-9 ]|\\s+/g, \"\")\r\n                // Remove spaces and dash from Code\r\n                const Code = this.Form.Code.replace(/-|\\s+/g, \"\")\r\n                this.$store.dispatch(LOGIN_REQUEST_TOKEN, {\r\n                    \"Phone\": Phone,\r\n                    \"Code\": Code\r\n                })\r\n                    .then(() => {\r\n                        clearInterval(this.Timer)\r\n                        this.$router.replace(this.$route.query.redirect || \"/\")\r\n                    })\r\n                    .finally(() => this.switchLoading())\r\n            }\r\n        },\r\n        resend() {\r\n            this.setTimerAgain(180)\r\n            this.sendcode()\r\n        }\r\n    }\r\n}\r\n</script>\r\n","export default {\r\n    data: () => ({\r\n        Timeover: false,\r\n        Timeout: 360,\r\n        Timer: null\r\n    }),\r\n    computed: {\r\n        TimeoutBeauty() {\r\n            const SecondsNumber = parseInt(this.Timeout, 10)\r\n            const Hours = Math.floor(SecondsNumber / 3600)\r\n            let Minutes = Math.floor((SecondsNumber - (Hours * 3600)) / 60)\r\n            let Seconds = SecondsNumber - (Hours * 3600) - (Minutes * 60)\r\n\r\n            if (Minutes < 10) {\r\n                Minutes = `0${Minutes}`\r\n            }\r\n            if (Seconds < 10) {\r\n                Seconds = `0${Seconds}`\r\n            }\r\n\r\n            return `${Minutes}:${Seconds}`\r\n        }\r\n    },\r\n    methods: {\r\n        decrementTimer() {\r\n            this.Timeout -= 1\r\n            if (this.Timeout <= 0) {\r\n                this.Timeover = true\r\n                clearInterval(this.Timer)\r\n            }\r\n        },\r\n        setTimer() {\r\n            this.Timer = setInterval(this.decrementTimer, 1000)\r\n        },\r\n        setTimerAgain(seconds) {\r\n            this.Timeover = false\r\n            this.Timeout = seconds\r\n        }\r\n    },\r\n    beforeUnmount() {\r\n        clearInterval(this.Timer)\r\n    }\r\n}\r\n","import { render } from \"./Login.vue?vue&type=template&id=81403e1a\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}